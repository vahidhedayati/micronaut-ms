plugins {
    id "io.spring.dependency-management" version "1.0.6.RELEASE"
    id "com.github.johnrengelman.shadow" version "4.0.2"
    id "net.ltgt.apt-eclipse" version "0.18"
    id "net.ltgt.apt-idea" version "0.18"
}
subprojects { project ->

    if(!project.path.contains(':frontend')) {
        apply plugin: "java"



        apply plugin: "io.spring.dependency-management"

        if (project.name != 'api' && project.name != 'functions') {

            apply plugin: "application"
            apply plugin: 'com.github.johnrengelman.shadow'
            shadowJar {
                mergeServiceFiles()
            }
        }

        repositories {
            mavenLocal()
            jcenter()
            mavenCentral()
            maven { url "https://jcenter.bintray.com" }
        }

        dependencyManagement {
            imports {
                mavenBom 'io.micronaut:micronaut-bom:1.0.4'
            }
        }

        dependencies {

            if ((project.path.contains(':tab'))||project.path.contains(':billing')||project.path.contains(':frontend')) {
                compile "io.micronaut.configuration:micronaut-kafka"
            }
            if (project.name == 'gateway') {
                compile "com.ecwid.consul:consul-api:1.4.1"

            }


            if (project.name != 'something' && !project.path.contains(':someFunction') && !project.path.contains(':frontend')) {
                // https://mvnrepository.com/artifact/org.apache.commons/commons-lang3
                //compile group: 'org.apache.commons', name: 'commons-lang3', version: '3.0'
                compile "io.micronaut.configuration:micronaut-hibernate-validator"
                compile "io.micronaut.configuration:micronaut-hibernate-gorm"
                compile "io.micronaut:micronaut-http-client"

                compile "io.micronaut:micronaut-discovery-client"

                runtime "com.h2database:h2:1.4.196"
                runtime "org.apache.tomcat:tomcat-jdbc:8.0.44"

                compile "io.micronaut:micronaut-tracing"
                //

                compile "io.micronaut.configuration:micronaut-mongo-reactive"

                //
               // compile "io.micronaut:micronaut-tracing"
                runtime 'io.zipkin.brave:brave-instrumentation-http:5.4.2'
                runtime 'io.zipkin.reporter2:zipkin-reporter:2.7.9'
                compile 'io.opentracing.brave:brave-opentracing:0.33.3'

                // https://mvnrepository.com/artifact/org.projectlombok/lombok
                compile group: 'org.projectlombok', name: 'lombok', version: '1.18.2'
            }
        }
    }
}
